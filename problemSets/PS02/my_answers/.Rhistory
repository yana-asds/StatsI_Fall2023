#before police
#after police
# Scatter plot
plot(df$water,df$female)
# Save model as object
model <- lm(water~female, data=df)
summary(model)
sprintf("%.20f",2.17e-06)
# Save model as object
model1 <- lm(water~reserved, data=df)
summary(model1)
sprintf("%.20f",2.17e-06)
# Fit linear regression model
summary(lm(df$water~df$female))
es
summary(lm(df$water~df$reserved))
a <- c(38, 38, 35, 90)
var(a)
sd(a)
a <- c(38, 38, 35)
var(a)
sd(a)
#2.
df <- read.csv("https://raw.githubusercontent.com/kosukeimai/qss/master/PREDICTION/women.csv")
View(df)
ummary(lm(df$water~df$female))
summary(lm(df$water~df$female))
summary(lm(df$water~df$reserved))
summary(lm(df$irrigation~df$female))
summary(lm(df$irrigation~df$reserved))
mean(df$women)
mean(df$reserved)
# there is no association between X and Y , β = 0 (H0)
# there is an association between X and Y , β ̸= 0 (Ha)
mean(df$women)
# there is no association between X and Y , β = 0 (H0)
# there is an association between X and Y , β ̸= 0 (Ha)
mean(df$female)
mean(df$reserved)
se(df$female)
sd(df$reserved)
se <- sd(df$female)/sqrt(lenght(df$female))
se <- sd(df$female)/sqrt(length(df$female))
se
se2 <- sd(df$reserved)/sqrt(length(df$reserved))
se2
se_total <- sqrt(se1^2 + se2^2)
se1 <- sd(df$female)/sqrt(length(df$female))
se1
se2 <- sd(df$reserved)/sqrt(length(df$reserved))
se2
se_total <- sqrt(se1^2 + se2^2)
se_total
mean_f< - mean(df$female)
ratio = mean_f/mean_r
mean_f< - mean(df$female)
mean_f <- mean(df$female)
mean_r <- mean(df$reserved)
ratio = mean_f/mean_r
ratio
boxplot(df$water,df$female)
boxplot(df$water~df$female, )
boxplot(df$water~df$female, xlab = "Female", ylab = "Water Facility", main="")
pdf("plot2_1.pdf")
boxplot(df$water~df$female, xlab = "Female", ylab = "Water Facility", main="")
def.off()
pdf("plot2_1.pdf")
boxplot(df$water~df$female, xlab = "Female", ylab = "Water Facility", main="")
dev.off()
#library(readr)
#library(tidyverse)
library(ggplot2)
#library(readr)
#library(tidyverse)
library(ggplot2)
#2.
df <- read.csv("https://raw.githubusercontent.com/kosukeimai/qss/master/PREDICTION/women.csv")
boxplot(df$water~df$female, xlab = "Female", ylab = "Water Facility", main="")
pdf("plot2_1.pdf")
boxplot(df$water~df$female, xlab = "Female", ylab = "Water Facility", main="")
dev.off()
pdf("plot2_1.pdf")
boxplot(water ~ female, data =df, xlab = "Female", ylab = "Water Facility", main="")
dev.off()
#library(readr)
#library(tidyverse)
library(ggplot2)
#2.
df <- read.csv("https://raw.githubusercontent.com/kosukeimai/qss/master/PREDICTION/women.csv")
pdf("plot2_1.pdf")
boxplot(water ~ female, data =df, xlab = "Female", ylab = "Water Facility", main="")
dev.off()
boxplot(water ~ female, data =df, xlab = "Female", ylab = "Water Facility", main="")
pdf("plot2_1.pdf")
boxplot(water ~ female, data =df, xlab = "Female", ylab = "Water Facility", main="")
dev.off()
boxplot(irrigation ~ female, data =df, xlab = "Female", ylab = "Irrigation", main="")
# Calculate correlation
cor(df$water,df$female)
# t-test for the correlation coefficient
cor.test(df$water, df$female)
fe11 <- 27*21/42
fe11
fe11 <- 27*21/42
fe11
fe12 <- 27*13/42
fe12
fe13 <- 27*8/42
fe13
fe21 <- 15*21/42
fe21
fe22 <- 15*13/42
fe22
fe23 <- 15*8/42
fe23
regressMat <- matrix(c(14, 6, 7, 7, 7, 1), nrow = 2, byrow = T)
fe11 <- 27*21/42
fe11
fe12 <- 27*13/42
fe12
fe13 <- 27*8/42
fe13
fe21 <- 15*21/42
fe21
fe22 <- 15*13/42
fe22
fe23 <- 15*8/42
fe23
chi_squared <- (regressMat[1,1] - fe11)^2/fe11 + (regressMat[1,2] - fe12)^2/fe12 +
(regressMat[1,3] - fe13)^2/fe13 + (regressMat[2,1] - fe21)^2/fe21 +
(regressMat[2,2] - fe22)^2/fe22 + (regressMat[2,3] - fe23)^2/fe23
chi_squared
#2.Calculate the p-value
p_value <- pchisq(chi_squared, df = (nrow(regressMat) - 1)* (ncol(regressMat) - 1), lower.tail = FALSE)
p_value
#3.Calculating the standardized residuals for each cell
result$stdres
# Calculating Chi-test
observ <- regressMat
result <- chisq.test(regressMat)
result
chi_squared <-result$statistic
chi_squared
#2.Calculate the p-value
p_value <- pchisq(chi_squared, df = (nrow(regressMat) - 1)* (ncol(regressMat) - 1), lower.tail = FALSE)
p_value
#3.Calculating the standardized residuals for each cell
result$stdres
residualsMat <- matrix(c(result$stdres), nrow = 2, byrow = T)
residualsMat
chi_squared$stdres
chi_Mat$stdres
chi_Mat <- matrix(c(chi_squared), nrow = 2, byrow = T)
chi_Mat$stdres
observ <- regressMat
result <- chisq.test(regressMat)
chi_squared <-result$statistic
chi_squared
stand_residuals <- result$stdres
table <- as.table(stand_residuals)
table
stand_residuals <- result$stdres
table <- as.table(stand_residuals)
colnames(table) <- c("", "", "")
rownames(table) <- c("", "", "")
stand_residuals <- result$stdres
table <- as.table(stand_residuals)
colnames(table) <- c("", "", "")
rownames(table) <- c("", "")
print(table)
stand_residuals <- result$stdres
table <- as.table(stand_residuals)
colnames(table) <- c("", "", "")
rownames(table) <- c("Upper Class", "Lower class")
print(table)
stand_residuals <- result$stdres
table <- as.table(stand_residuals)
colnames(table) <- c("Not Stopped", "Bribe requested", "Stopped/given warning")
rownames(table) <- c("Upper Class", "Lower class")
print(table)
# Calculating f expected values "by hand"
#The first row
fe11 <- 27*21/42
fe11
fe12 <- 27*13/42
fe12
fe13 <- 27*8/42
fe13
#The second row
fe21 <- 15*21/42
fe21
fe22 <- 15*13/42
fe22
fe23 <- 15*8/42
fe23
# Calculate the χ2 test statistic
chi_squared <- (regressMat[1,1] - fe11)^2/fe11 + (regressMat[1,2] - fe12)^2/fe12 +
(regressMat[1,3] - fe13)^2/fe13 + (regressMat[2,1] - fe21)^2/fe21 +
(regressMat[2,2] - fe22)^2/fe22 + (regressMat[2,3] - fe23)^2/fe23
chi_squared
# 1. Calculate the χ2 test statistic
# Creating matrix
regressMat <- matrix(c(14, 6, 7, 7, 7, 1), nrow = 2, byrow = T)
# Calculating f expected values "by hand"
#The first row
fe11 <- 27*21/42
fe12 <- 27*13/42
fe13 <- 27*8/42
#The second row
fe21 <- 15*21/42
fe22 <- 15*13/42
fe23 <- 15*8/42
# Calculate the χ2 test statistic
chi_squared <- (regressMat[1,1] - fe11)^2/fe11 + (regressMat[1,2] - fe12)^2/fe12 +
(regressMat[1,3] - fe13)^2/fe13 + (regressMat[2,1] - fe21)^2/fe21 +
(regressMat[2,2] - fe22)^2/fe22 + (regressMat[2,3] - fe23)^2/fe23
chi_squared
# Check Chi-test value using function chisq.test
observ <- regressMat
result <- chisq.test(regressMat)
chi_squared <-result$statistic
chi_squared
#2.Calculate the p-value
p_value <- pchisq(chi_squared, df = (nrow(regressMat) - 1)* (ncol(regressMat) - 1), lower.tail = FALSE)
p_value
#3.Calculating the standardized residuals for each cell
# and putting them in the table
stand_residuals <- chi_squared$stdres
result <- chisq.test(regressMat)
stand_residuals <- result$stdres
table <- as.table(stand_residuals)
colnames(table) <- c("Not Stopped", "Bribe requested", "Stopped/given warning")
rownames(table) <- c("Upper Class", "Lower class")
print(table)
# 1. Calculate the χ2 test statistic
# Creating matrix
regressMat <- matrix(c(14, 6, 7, 7, 7, 1), nrow = 2, byrow = T)
# Calculating f expected values "by hand"
#The first row
fe11 <- 27*21/42
fe12 <- 27*13/42
fe13 <- 27*8/42
#The second row
fe21 <- 15*21/42
fe22 <- 15*13/42
fe23 <- 15*8/42
# Calculate the χ2 test statistic
chi_squared <- (regressMat[1,1] - fe11)^2/fe11 + (regressMat[1,2] - fe12)^2/fe12 +
(regressMat[1,3] - fe13)^2/fe13 + (regressMat[2,1] - fe21)^2/fe21 +
(regressMat[2,2] - fe22)^2/fe22 + (regressMat[2,3] - fe23)^2/fe23
chi_squared
# Check Chi-test value using function chisq.test
#observ <- regressMat
#result <- chisq.test(regressMat)
#chi_squared <-result$statistic
#chi_squared
#2.Calculate the p-value
p_value <- pchisq(chi_squared, df = (nrow(regressMat) - 1)* (ncol(regressMat) - 1), lower.tail = FALSE)
p_value
#3.Calculating the standardized residuals for each cell
# and putting them in the table
result <- chisq.test(regressMat)
stand_residuals <- result$stdres
table <- as.table(stand_residuals)
colnames(table) <- c("Not Stopped", "Bribe requested", "Stopped/given warning")
rownames(table) <- c("Upper Class", "Lower class")
print(table)
plot(water ~ female$1, data =df, xlab = "Female", ylab = "Irrigation", main="")
plot(water ~ gp, data =df, xlab = "Female", ylab = "Irrigation", main="")
plot(water ~ GP, data =df, xlab = "Female", ylab = "Irrigation", main="")
plot(water ~ GP, data =df, xlab = "GP", pch=as.integer(df$female) ,ylab = "Water Facilites", main="")
plot(water ~ GP, data =df, xlab = "GP", colour = df$female ,ylab = "Water Facilites", main="")
plot(water ~ GP, data =df, xlab = "GP", pch = df$female ,ylab = "Water Facilites", main="")
plot(water ~ female, data = df, xlab = "GP" ,ylab = "Water Facilites", main="")
plot(water ~ GP, data = df, xlab = "GP" ,ylab = "Water Facilites", main="")
library(ggplot2)
# 1. Calculate the χ2 test statistic
# Creating matrix
regressMat <- matrix(c(14, 6, 7, 7, 7, 1), nrow = 2, byrow = T)
# Calculating f expected values "by hand"
#The first row
fe11 <- 27*21/42
fe12 <- 27*13/42
fe13 <- 27*8/42
#The second row
fe21 <- 15*21/42
fe22 <- 15*13/42
fe23 <- 15*8/42
# Calculate the χ2 test statistic
chi_squared <- (regressMat[1,1] - fe11)^2/fe11 + (regressMat[1,2] - fe12)^2/fe12 +
(regressMat[1,3] - fe13)^2/fe13 + (regressMat[2,1] - fe21)^2/fe21 +
(regressMat[2,2] - fe22)^2/fe22 + (regressMat[2,3] - fe23)^2/fe23
chi_squared
#2.Calculate the p-value
p_value <- pchisq(chi_squared, df = (nrow(regressMat) - 1)* (ncol(regressMat) - 1), lower.tail = FALSE)
p_value
#3.Calculating the standardized residuals for each cell
# and putting them in the table
result <- chisq.test(regressMat)
stand_residuals <- result$stdres
table <- as.table(stand_residuals)
colnames(table) <- c("Not Stopped", "Bribe requested", "Stopped/given warning")
rownames(table) <- c("Upper Class", "Lower class")
print(table)
data <- read_csv("https://raw.githubusercontent.com/kosukeimai/qss/master/PREDICTION/women.csv")
data <- read.csv("https://raw.githubusercontent.com/kosukeimai/qss/master/PREDICTION/women.csv")
View(data)
summary(data)
# Perform the bivariate regression
model <- lm(water ~ female, data = data)
# Summarize the regression results
summary(model)
df <- read.csv("https://raw.githubusercontent.com/kosukeimai/qss/master/PREDICTION/women.csv")
View(df)
# (a) State a null and alternative (two-tailed) hypothesis.
# The authors hypothesize that female politicians
# are more likely to support policies female voters want
# H0 = The reservation policy for the female vilage council heads
#has no effect on the number of new or repaired drinking water
#facilities in the villages
# there is no association between X and Y , β = 0 (H0)
# there is an association between X and Y , β ̸= 0 (Ha)
# (b) Run a bivariate regression to test this hypothesis in R (include your code!).
# Calculate correlation
cor(df$water,df$female)
cor(df$water,df$reserved)
cor.test(df$water, df$female)
cor.test(df$water, df$reserved)
# Fit linear regression model
summary(lm(df$water~df$female))
summary(lm(df$water~df$reserved))
# Perform the bivariate regression
model <- lm(water ~ female, data = data)
df <- read.csv("https://raw.githubusercontent.com/kosukeimai/qss/master/PREDICTION/women.csv")
View(df)
# H0 = The reservation policy for the female village council heads
# has no effect on the number of new or repaired drinking water
# facilities in the villages
# there is no association between X and Y , β = 0 (H0)
# there is an association between X and Y , β ̸= 0 (Ha)
# (b) Run a bivariate regression to test this hypothesis in R (include your code!).
# Calculate correlation
#cor(df$water,df$female)
#cor(df$water,df$reserved)
# t-test for the correlation coefficient
#cor.test(df$water, df$female)
#cor.test(df$water, df$reserved)
# Fit linear regression model
#summary(lm(df$water~df$female))
#summary(lm(df$water~df$reserved))
# Save model as object
#model <- lm(water~female, data=df)
#summary(model)
#sprintf("%.20f",2.17e-06)
# Perform the bivariate regression
model <- lm(water ~ female, data = data)
# Summarize the regression results
summary(model)
sprintf("%.20f",2.17e-06)
sprintf("%.20f",1.56e-09)
# 1. Calculate the χ2 test statistic
# Creating matrix
regressMat <- matrix(c(14, 6, 7, 7, 7, 1), nrow = 2, byrow = T)
# 1. Calculate the χ2 test statistic
# Creating matrix
regressMat <- matrix(c(14, 6, 7, 7, 7, 1), nrow = 2, byrow = T)
# Calculating f expected values "by hand"
#The first row of the table
fe11 <- 27*21/42
fe12 <- 27*13/42
fe13 <- 27*8/42
#The second row of the table
fe21 <- 15*21/42
fe22 <- 15*13/42
fe23 <- 15*8/42
# Calculate the chi-squared test statistic
chi_squared <- (regressMat[1,1] - fe11)^2/fe11 + (regressMat[1,2] - fe12)^2/fe12 +
(regressMat[1,3] - fe13)^2/fe13 + (regressMat[2,1] - fe21)^2/fe21 +
(regressMat[2,2] - fe22)^2/fe22 + (regressMat[2,3] - fe23)^2/fe23
chi_squared
#2.Calculate the p-value
p_value <- pchisq(chi_squared, df = (nrow(regressMat) - 1)* (ncol(regressMat) - 1), lower.tail = FALSE)
p_value
#2.Calculate the p-value
p_value <- pchisq(chi_squared, df = (nrow(regressMat) - 1)* (ncol(regressMat) - 1), lower.tail = FALSE)
p_value
#3.Calculating the standardized residuals for each cell
# and putting them in the table
result <- chisq.test(regressMat)
stand_residuals <- result$stdres
table <- as.table(stand_residuals)
colnames(table) <- c("Not Stopped", "Bribe requested", "Stopped/given warning")
rownames(table) <- c("Upper Class", "Lower class")
print(table)
result <- chisq.test(regressMat)
stand_residuals <- result$stdres
stand_residuals
# (b) Running a bivariate regression to test this hypothesis in R (include your code!).
# Perform the bivariate regression
model <- lm(water ~ reserved, data = data)
#2.(a) State a null and alternative (two-tailed) hypothesis.
df <- read.csv("https://raw.githubusercontent.com/kosukeimai/qss/master/PREDICTION/women.csv")
View(df)
# H0 = The reservation policy for the female village council heads
# has no effect on the number of new or repaired drinking water
# facilities in the villages (there is no association between X and Y)
# (Ha) there is an association between X and Y
# (b) Running a bivariate regression to test this hypothesis in R (include your code!).
# Perform the bivariate regression
model <- lm(water ~ reserved, data = data)
#2.(a) State a null and alternative (two-tailed) hypothesis.
df <- read.csv("https://raw.githubusercontent.com/kosukeimai/qss/master/PREDICTION/women.csv")
View(df)
# H0 = The reservation policy for the female village council heads
# has no effect on the number of new or repaired drinking water
# facilities in the villages (there is no association between X and Y)
# (Ha) there is an association between X and Y
# (b) Running a bivariate regression to test this hypothesis in R (include your code!).
# Perform the bivariate regression
model <- lm(water ~ reserved, data = df)
# Summarize the regression results
summary(model)
sprintf("%.20f",1.56e-09)
sprintf("%.20f",4.22e-10)
#2.(a) State a null and alternative (two-tailed) hypothesis.
df <- read.csv("https://raw.githubusercontent.com/kosukeimai/qss/master/PREDICTION/women.csv")
View(df)
# H0 = The reservation policy for the female village council heads
# has no effect on the number of new or repaired drinking water
# facilities in the villages (there is no association between X and Y)
# (Ha) there is an association between X and Y
# (b) Running a bivariate regression to test this hypothesis in R (include your code!).
# Perform the bivariate regression
model <- lm(water ~ reserved, data = df)
# Summarize the regression results
summary(model)
sprintf("%.20f",4.22e-10)
#2.(a) State a null and alternative (two-tailed) hypothesis.
# Viewing csv file with data and assigning data to vector df
df <- read.csv("https://raw.githubusercontent.com/kosukeimai/qss/master/PREDICTION/women.csv")
View(df)
# Perform the bivariate regression
model <- lm(water ~ reserved, data = df)
# Summarize the regression results
summary(model)
# 1. Calculate the χ2 test statistic
# Creating matrix
regressMat <- matrix(c(14, 6, 7, 7, 7, 1), nrow = 2, byrow = T)
# Calculating f expected values "by hand"
#The first row of the table
fe11 <- 27*21/42
fe12 <- 27*13/42
fe13 <- 27*8/42
#The second row of the table
fe21 <- 15*21/42
fe22 <- 15*13/42
fe23 <- 15*8/42
# Calculate the chi-squared test statistic
chi_squared <- (regressMat[1,1] - fe11)^2/fe11 + (regressMat[1,2] - fe12)^2/fe12 +
(regressMat[1,3] - fe13)^2/fe13 + (regressMat[2,1] - fe21)^2/fe21 +
(regressMat[2,2] - fe22)^2/fe22 + (regressMat[2,3] - fe23)^2/fe23
chi_squared
#2.Calculate the p-value
p_value <- pchisq(chi_squared, df = (nrow(regressMat) - 1)* (ncol(regressMat) - 1), lower.tail = FALSE)
p_value
#3.Calculating the standardized residuals for each cell
# and putting them in the table
result <- chisq.test(regressMat)
stand_residuals <- result$stdres
table <- as.table(stand_residuals)
colnames(table) <- c("Not Stopped", "Bribe requested", "Stopped/given warning")
rownames(table) <- c("Upper Class", "Lower class")
print(table)
#library(readr)
#library(tidyverse)
#library(ggplot2)
# 1. Calculate the χ2 test statistic
# Creating matrix
regressMat <- matrix(c(14, 6, 7, 7, 7, 1), nrow = 2, byrow = T)
# Calculating f expected values "by hand"
#The first row of the table
fe11 <- 27*21/42
fe12 <- 27*13/42
fe13 <- 27*8/42
#The second row of the table
fe21 <- 15*21/42
fe22 <- 15*13/42
fe23 <- 15*8/42
# Calculate the chi-squared test statistic
chi_squared <- (regressMat[1,1] - fe11)^2/fe11 + (regressMat[1,2] - fe12)^2/fe12 +
(regressMat[1,3] - fe13)^2/fe13 + (regressMat[2,1] - fe21)^2/fe21 +
(regressMat[2,2] - fe22)^2/fe22 + (regressMat[2,3] - fe23)^2/fe23
chi_squared
#2.Calculate the p-value
p_value <- pchisq(chi_squared, df = (nrow(regressMat) - 1)* (ncol(regressMat) - 1), lower.tail = FALSE)
p_value
#3.Calculating the standardized residuals for each cell
# and putting them in the table
result <- chisq.test(regressMat)
stand_residuals <- result$stdres
table <- as.table(stand_residuals)
colnames(table) <- c("Not Stopped", "Bribe requested", "Stopped/given warning")
rownames(table) <- c("Upper Class", "Lower class")
print(table)
#2.(a) State a null and alternative (two-tailed) hypothesis.
# Viewing csv file with data and assigning data to vector df
df <- read.csv("https://raw.githubusercontent.com/kosukeimai/qss/master/PREDICTION/women.csv")
View(df)
# Perform the bivariate regression
model <- lm(water ~ reserved, data = df)
# Summarize the regression results
summary(model)
